version: '3.9'
services:
  node_backend:
    container_name: node_backend
    image: node:latest
    restart: on-failure
    build: .  
    depends_on:
      - postgres
    ports:
      - '3500:3500'
    volumes:
      # Maps our current project directory `.` to
      # our working directory in the container
      - ./:/usr/src/app/

  postgres:
    container_name: postgres
    image: postgres:latest
    ports:
      - '5434:5432'
    environment:
      - POSTGRES_USER=${POSTGRES_USER}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
    volumes:
        # When the PostgresSQL container is started it will run any scripts
        # provided in the `docker-entrypoint-initdb.d` directory, this connects
        # our seed file to that directory so that it gets run
        - ./database-seed.sql:/docker-entrypoint-initdb.d/database-seed.sql

  pgadmin-compose:
        image: dpage/pgadmin4
        environment:
            PGADMIN_DEFAULT_EMAIL: "placeholder@example.com"
            PGADMIN_DEFAULT_PASSWORD: "fakepassword123!"
        ports:
            - "16543:80"
        depends_on:
            - postgres    